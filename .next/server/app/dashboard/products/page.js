(()=>{var e={};e.id=95,e.ids=[95],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5124:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>l,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(7599),s(6327),s(7564),s(5866);var r=s(3191),a=s(8716),o=s(7922),i=s.n(o),n=s(5231),u={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(u[e]=()=>n[e]);s.d(t,u);let c=["",{children:["dashboard",{children:["products",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7599)),"/home/hall/Downloads/HomeAssessment/baisoft-marketplace/frontend/app/dashboard/products/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6327)),"/home/hall/Downloads/HomeAssessment/baisoft-marketplace/frontend/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7564)),"/home/hall/Downloads/HomeAssessment/baisoft-marketplace/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/hall/Downloads/HomeAssessment/baisoft-marketplace/frontend/app/dashboard/products/page.tsx"],l="/dashboard/products/page",p={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/products/page",pathname:"/dashboard/products",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7882:(e,t,s)=>{Promise.resolve().then(s.bind(s,2172))},2172:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(326),a=s(5047),o=s(447),i=s(5035),n=s(772),u=s(3071),c=s(567),d=s(5578);let l=(0,d.Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),p=(0,d.Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),h=(0,d.Z)("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);function m(){let{user:e}=(0,i.a)(),t=(0,a.useRouter)(),{products:s,isLoading:d,approveProduct:m,deleteProduct:x}=(0,o.k)(),y=e=>{m.mutate(e)},g=e=>{confirm("Are you sure you want to delete this product?")&&x.mutate(e)},v=e?.role?.can_create_product||e?.role?.name==="admin"||e?.role?.name==="editor",b=e?.role?.can_approve_product||e?.role?.name==="admin"||e?.role?.name==="approver",f=e?.role?.can_delete_product||e?.role?.name==="admin";return d?r.jsx("div",{children:"Loading products..."}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Products"}),v&&(0,r.jsxs)(n.z,{onClick:()=>t.push("/dashboard/products/new"),children:[r.jsx(l,{className:"mr-2 h-4 w-4"})," Create Product"]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,r.jsxs)(u.Zb,{children:[r.jsx(u.Ol,{children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[r.jsx(u.ll,{children:e.name}),r.jsx(c.C,{variant:"approved"===e.status?"default":"pending_approval"===e.status?"secondary":"outline",children:e.status.replace("_"," ")})]})}),(0,r.jsxs)(u.aY,{children:[r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:e.description}),(0,r.jsxs)("p",{className:"font-bold text-lg",children:["$",e.price]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:[(0,r.jsxs)("p",{children:["Business: ",e.business_name]}),(0,r.jsxs)("p",{children:["Created by: ",e.created_by_name]})]})]}),(0,r.jsxs)(u.eW,{className:"flex justify-end gap-2",children:[b&&"pending_approval"===e.status&&(0,r.jsxs)(n.z,{size:"sm",onClick:()=>y(e.id),children:[r.jsx(p,{className:"mr-2 h-4 w-4"})," Approve"]}),f&&(0,r.jsxs)(n.z,{size:"sm",variant:"destructive",onClick:()=>g(e.id),children:[r.jsx(h,{className:"mr-2 h-4 w-4"})," Delete"]})]})]},e.id))})]})}},447:(e,t,s)=>{"use strict";s.d(t,{k:()=>c});var r=s(4976),a=s(108),o=s(119),i=s(8329),n=s(5999),u=s(2254);function c(){let e=(0,r.NL)(),{setAppLoading:t}=(0,u.q)(),{data:s=[],isLoading:c,isError:d}=(0,a.a)({queryKey:["products"],queryFn:i.R.getProducts}),l=(0,o.D)({mutationFn:e=>i.R.createProduct(e),onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),n.Am.success("Product created successfully")},onError:e=>{n.Am.error(e.message||"Failed to create product")}});return{products:s,isLoading:c,isError:d,createProduct:l,updateProduct:(0,o.D)({mutationFn:({id:e,data:t})=>i.R.updateProduct(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),n.Am.success("Product updated successfully")},onError:e=>{n.Am.error(e.message||"Failed to update product")}}),deleteProduct:(0,o.D)({mutationFn:e=>i.R.deleteProduct(e),onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),n.Am.success("Product deleted successfully")},onError:e=>{n.Am.error(e.message||"Failed to delete product")}}),approveProduct:(0,o.D)({mutationFn:e=>i.R.approveProduct(e),onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),n.Am.success("Product approved successfully")},onError:e=>{n.Am.error(e.message||"Failed to approve product")}})}}},2374:(e,t,s)=>{"use strict";s.d(t,{h:()=>i});var r=s(4464),a=s(5999);let o=process.env.NEXT_PUBLIC_API_URL||"http://127.0.0.1:8000/api",i=r.Z.create({baseURL:o,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),i.interceptors.response.use(e=>e,async e=>{let t=e.config;e.response?.status!==401||t._retry||(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"));let s=e.response?.data?.detail||e.message||"An error occurred";return a.Am.error(s),Promise.reject(e)})},8329:(e,t,s)=>{"use strict";s.d(t,{R:()=>o});var r=s(2374);let a="/products",o={getProducts:async()=>(await r.h.get(`${a}/`)).data,getPublicProducts:async()=>(await r.h.get(`${a}/public/`)).data,getProduct:async e=>(await r.h.get(`${a}/${e}/`)).data,createProduct:async e=>(await r.h.post(`${a}/`,e)).data,updateProduct:async(e,t)=>(await r.h.put(`${a}/${e}/`,t)).data,approveProduct:async e=>(await r.h.post(`${a}/${e}/approve/`)).data,deleteProduct:async e=>{await r.h.delete(`${a}/${e}/`)}}},7599:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>o,default:()=>n});var r=s(8570);let a=(0,r.createProxy)(String.raw`/home/hall/Downloads/HomeAssessment/baisoft-marketplace/frontend/app/dashboard/products/page.tsx`),{__esModule:o,$$typeof:i}=a;a.default;let n=(0,r.createProxy)(String.raw`/home/hall/Downloads/HomeAssessment/baisoft-marketplace/frontend/app/dashboard/products/page.tsx#default`)},119:(e,t,s)=>{"use strict";s.d(t,{D:()=>d});var r=s(7577),a=s(1180),o=s(2113),i=s(4351),n=s(3341),u=class extends i.l{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,n.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,n.Ym)(t.mutationKey)!==(0,n.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#o(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#o()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,a.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#o(e){o.Vr.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#r.onSuccess?.(e.data,t,s,r)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(e.data,null,t,s,r)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#r.onError?.(e.error,t,s,r)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(void 0,e.error,t,s,r)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},c=s(4976);function d(e,t){let s=(0,c.NL)(t),[a]=r.useState(()=>new u(s,e));r.useEffect(()=>{a.setOptions(e)},[a,e]);let i=r.useSyncExternalStore(r.useCallback(e=>a.subscribe(o.Vr.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),d=r.useCallback((e,t)=>{a.mutate(e,t).catch(n.ZT)},[a]);if(i.error&&(0,n.L3)(a.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:d,mutateAsync:i.mutate}}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[156,404,326,464,302,108,193],()=>s(5124));module.exports=r})();