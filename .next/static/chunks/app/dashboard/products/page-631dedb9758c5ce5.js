(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{2022:function(e,t,r){Promise.resolve().then(r.bind(r,1731))},1731:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var n=r(7437),s=r(6463),a=r(7287),i=r(9592),o=r(495),u=r(6013),c=r(4693),d=r(8204);let l=(0,d.Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),p=(0,d.Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),h=(0,d.Z)("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);function v(){var e,t,r,d,v,m,f,g;let{user:b}=(0,i.a)(),y=(0,s.useRouter)(),{products:x,isLoading:k,approveProduct:j,deleteProduct:w}=(0,a.k)(),C=e=>{j.mutate(e)},_=e=>{confirm("Are you sure you want to delete this product?")&&w.mutate(e)},P=(null==b?void 0:null===(e=b.role)||void 0===e?void 0:e.can_create_product)||(null==b?void 0:null===(t=b.role)||void 0===t?void 0:t.name)==="admin"||(null==b?void 0:null===(r=b.role)||void 0===r?void 0:r.name)==="editor",N=(null==b?void 0:null===(d=b.role)||void 0===d?void 0:d.can_approve_product)||(null==b?void 0:null===(v=b.role)||void 0===v?void 0:v.name)==="admin"||(null==b?void 0:null===(m=b.role)||void 0===m?void 0:m.name)==="approver",R=(null==b?void 0:null===(f=b.role)||void 0===f?void 0:f.can_delete_product)||(null==b?void 0:null===(g=b.role)||void 0===g?void 0:g.name)==="admin";return k?(0,n.jsx)("div",{children:"Loading products..."}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Products"}),P&&(0,n.jsxs)(o.z,{onClick:()=>y.push("/dashboard/products/new"),children:[(0,n.jsx)(l,{className:"mr-2 h-4 w-4"})," Create Product"]})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(e=>(0,n.jsxs)(u.Zb,{children:[(0,n.jsx)(u.Ol,{children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsx)(u.ll,{children:e.name}),(0,n.jsx)(c.C,{variant:"approved"===e.status?"default":"pending_approval"===e.status?"secondary":"outline",children:e.status.replace("_"," ")})]})}),(0,n.jsxs)(u.aY,{children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:e.description}),(0,n.jsxs)("p",{className:"font-bold text-lg",children:["$",e.price]}),(0,n.jsxs)("div",{className:"text-xs text-muted-foreground mt-2",children:[(0,n.jsxs)("p",{children:["Business: ",e.business_name]}),(0,n.jsxs)("p",{children:["Created by: ",e.created_by_name]})]})]}),(0,n.jsxs)(u.eW,{className:"flex justify-end gap-2",children:[N&&"pending_approval"===e.status&&(0,n.jsxs)(o.z,{size:"sm",onClick:()=>C(e.id),children:[(0,n.jsx)(p,{className:"mr-2 h-4 w-4"})," Approve"]}),R&&(0,n.jsxs)(o.z,{size:"sm",variant:"destructive",onClick:()=>_(e.id),children:[(0,n.jsx)(h,{className:"mr-2 h-4 w-4"})," Delete"]})]})]},e.id))})]})}},4693:function(e,t,r){"use strict";r.d(t,{C:function(){return u}});var n=r(7437);r(2265);var s=r(1538),a=r(3027),i=r(7440);let o=(0,a.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:t,variant:r,asChild:a=!1,...u}=e,c=a?s.g7:"span";return(0,n.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(o({variant:r}),t),...u})}},495:function(e,t,r){"use strict";r.d(t,{z:function(){return u}});var n=r(7437);r(2265);var s=r(1538),a=r(3027),i=r(7440);let o=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:t,variant:r,size:a,asChild:u=!1,...c}=e,d=u?s.g7:"button";return(0,n.jsx)(d,{"data-slot":"button",className:(0,i.cn)(o({variant:r,size:a,className:t})),...c})}},6013:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return u},Zb:function(){return a},aY:function(){return c},eW:function(){return d},ll:function(){return o}});var n=r(7437);r(2265);var s=r(7440);function a(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function o(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...r})}function u(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...r})}function c(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...r})}function d(e){let{className:t,...r}=e;return(0,n.jsx)("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center px-6 [.border-t]:pt-6",t),...r})}},5732:function(e,t,r){"use strict";r.d(t,{q:function(){return o}});var n=r(2265),s=r(6463),a=r(1444),i=r(2785);function o(){let e=(0,a.I0)(),t=(0,s.useRouter)(),r=(0,a.v9)(e=>e.app),o=(0,n.useCallback)(()=>{e((0,i.GB)())},[e]),u=(0,n.useCallback)(t=>{e((0,i.li)(t))},[e]),c=(0,n.useCallback)(t=>{e((0,i.Dc)(t))},[e]),d=(0,n.useCallback)(t=>{e((0,i.K4)(t))},[e]),l=(0,n.useCallback)((e,r)=>{(null==r?void 0:r.replace)?t.replace(e):t.push(e)},[t]),p=(0,n.useCallback)(t=>{e((0,i.li)(t))},[e]),h=(0,n.useCallback)(()=>{e((0,i.li)(!1)),e((0,i.K4)(!1))},[e]);return{...r,toggleSidebar:o,setSidebarOpen:u,setTheme:c,setAppLoading:d,navigate:l,toggleMenu:p,reset:h}}},9592:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var n=r(2265),s=r(1444),a=r(7586),i=r(6463);function o(){var e,t;let r=(0,i.useRouter)(),o=(0,s.I0)(),u=(0,s.v9)(e=>e.auth),c=(0,n.useCallback)(e=>{o((0,a.M)(e))},[o]),d=(0,n.useCallback)(e=>{o((0,a.o4)(e))},[o]),l=(0,n.useCallback)(e=>{o((0,a.gD)(e))},[o]),p=(0,n.useCallback)(e=>{o((0,a.BF)(e))},[o]),h=(0,n.useCallback)(async()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),o((0,a.kS)()),r.push("/auth/login")},[o,r]),v="admin"===u.role,m="editor"===u.role,f="approver"===u.role,g=null===(t=null===(e=u._persist)||void 0===e?void 0:e.rehydrated)||void 0===t||t;return{...u,user:u.userInfo,loading:!g,router:r,signOut:h,getRole:l,getToken:d,getUser:c,authenticate:p,isAdmin:v,isEditor:m,isApprover:f}}},7287:function(e,t,r){"use strict";r.d(t,{k:function(){return c}});var n=r(3191),s=r(5118),a=r(5524),i=r(9801),o=r(7776),u=r(5732);function c(){let e=(0,n.NL)(),{setAppLoading:t}=(0,u.q)(),{data:r=[],isLoading:c,isError:d}=(0,s.a)({queryKey:["products"],queryFn:i.R.getProducts}),l=(0,a.D)({mutationFn:e=>i.R.createProduct(e),onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),o.Am.success("Product created successfully")},onError:e=>{o.Am.error(e.message||"Failed to create product")}});return{products:r,isLoading:c,isError:d,createProduct:l,updateProduct:(0,a.D)({mutationFn:e=>{let{id:t,data:r}=e;return i.R.updateProduct(t,r)},onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),o.Am.success("Product updated successfully")},onError:e=>{o.Am.error(e.message||"Failed to update product")}}),deleteProduct:(0,a.D)({mutationFn:e=>i.R.deleteProduct(e),onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),o.Am.success("Product deleted successfully")},onError:e=>{o.Am.error(e.message||"Failed to delete product")}}),approveProduct:(0,a.D)({mutationFn:e=>i.R.approveProduct(e),onSuccess:()=>{e.invalidateQueries({queryKey:["products"]}),o.Am.success("Product approved successfully")},onError:e=>{o.Am.error(e.message||"Failed to approve product")}})}}},7440:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(4839),s=r(6164);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}},8204:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(2265);/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.564.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},d=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:d="",children:l,iconNode:p,...h}=e;return(0,n.createElement)("svg",{ref:t,...u,width:a,height:a,stroke:r,strokeWidth:o?24*Number(i)/Number(a):i,className:s("lucide",d),...!l&&!c(h)&&{"aria-hidden":"true"},...h},[...p.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(l)?l:[l]])}),l=(e,t)=>{let r=(0,n.forwardRef)((r,i)=>{let{className:u,...c}=r;return(0,n.createElement)(d,{ref:i,iconNode:t,className:s("lucide-".concat(a(o(e))),"lucide-".concat(e),u),...c})});return r.displayName=o(e),r}},6463:function(e,t,r){"use strict";var n=r(1169);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},2785:function(e,t,r){"use strict";r.d(t,{Dc:function(){return i},GB:function(){return s},K4:function(){return o},li:function(){return a}});let n=(0,r(1116).oM)({name:"app",initialState:{sidebarOpen:!0,theme:"system",loading:!1},reducers:{toggleSidebar:e=>{e.sidebarOpen=!e.sidebarOpen},setSidebarOpen:(e,t)=>{e.sidebarOpen=t.payload},setTheme:(e,t)=>{e.theme=t.payload},setLoading:(e,t)=>{e.loading=t.payload}}}),{toggleSidebar:s,setSidebarOpen:a,setTheme:i,setLoading:o}=n.actions;t.ZP=n.reducer},7586:function(e,t,r){"use strict";r.d(t,{BF:function(){return u},M:function(){return o},gD:function(){return a},kS:function(){return s},o4:function(){return i}});let n=(0,r(1116).oM)({name:"auth",initialState:{role:null,token:null,userInfo:null,isAuthenticated:!1},reducers:{logout:e=>{e.role=null,e.token=null,e.userInfo=null,e.isAuthenticated=!1},setUserData:(e,t)=>{e.userInfo=t.payload,t.payload.role&&(e.role="string"==typeof t.payload.role?t.payload.role:t.payload.role.name)},setToken:(e,t)=>{e.token=t.payload},setRole:(e,t)=>{e.role=t.payload},setIsAuthenticated:(e,t)=>{e.isAuthenticated=t.payload}}}),{logout:s,setRole:a,setToken:i,setUserData:o,setIsAuthenticated:u}=n.actions;t.ZP=n.reducer},459:function(e,t,r){"use strict";r.d(t,{h:function(){return i}});var n=r(8472),s=r(7776);let a=r(357).env.NEXT_PUBLIC_API_URL||"http://127.0.0.1:8000/api",i=n.Z.create({baseURL:a,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),i.interceptors.response.use(e=>e,async e=>{var t,r,n;let a=e.config;(null===(t=e.response)||void 0===t?void 0:t.status)!==401||a._retry||(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"));let i=(null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.detail)||e.message||"An error occurred";return s.Am.error(i),Promise.reject(e)})},9801:function(e,t,r){"use strict";r.d(t,{R:function(){return a}});var n=r(459);let s="/products",a={getProducts:async()=>(await n.h.get("".concat(s,"/"))).data,getPublicProducts:async()=>(await n.h.get("".concat(s,"/public/"))).data,getProduct:async e=>(await n.h.get("".concat(s,"/").concat(e,"/"))).data,createProduct:async e=>(await n.h.post("".concat(s,"/"),e)).data,updateProduct:async(e,t)=>(await n.h.put("".concat(s,"/").concat(e,"/"),t)).data,approveProduct:async e=>(await n.h.post("".concat(s,"/").concat(e,"/approve/"))).data,deleteProduct:async e=>{await n.h.delete("".concat(s,"/").concat(e,"/"))}}},5524:function(e,t,r){"use strict";r.d(t,{D:function(){return d}});var n=r(2265),s=r(2812),a=r(9948),i=r(9010),o=r(6298),u=class extends i.l{#e;#t=void 0;#r;#n;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#s(),this.#a()}mutate(e,t){return this.#n=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#s(){let e=this.#r?.state??(0,s.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#a(e){a.Vr.batch(()=>{if(this.#n&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context,n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#n.onSuccess?.(e.data,t,r,n)}catch(e){Promise.reject(e)}try{this.#n.onSettled?.(e.data,null,t,r,n)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#n.onError?.(e.error,t,r,n)}catch(e){Promise.reject(e)}try{this.#n.onSettled?.(void 0,e.error,t,r,n)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},c=r(3191);function d(e,t){let r=(0,c.NL)(t),[s]=n.useState(()=>new u(r,e));n.useEffect(()=>{s.setOptions(e)},[s,e]);let i=n.useSyncExternalStore(n.useCallback(e=>s.subscribe(a.Vr.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),d=n.useCallback((e,t)=>{s.mutate(e,t).catch(o.ZT)},[s]);if(i.error&&(0,o.L3)(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:d,mutateAsync:i.mutate}}}},function(e){e.O(0,[247,320,776,472,277,118,971,23,744],function(){return e(e.s=2022)}),_N_E=e.O()}]);